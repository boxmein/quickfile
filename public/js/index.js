!function(){"use strict";function setFile(file){console.log("changing file..."),$("#err_filesize").hide(),$("#err_empty").hide(),file.size>1048576&&$("#err_filesize").show(),_file=file}function getFile(){return console.log("retrieving file..."),_file}function progressCb(e){e.lengthComputable&&(console.log("new progress",e),$(".progress").attr({value:e.loaded,max:e.total}))}document.body.ondragover=function(){document.body.className="hover"},document.body.ondragend=function(){document.body.className=""};var _file=void 0;document.body.ondrop=function(evt){document.body.className="",evt.preventDefault(),evt.stopPropagation(),console.log("file dropped",evt.dataTransfer.files[0]),setFile(evt.dataTransfer.files[0])},$("#uploadFile").on("change",function(){this.files&&this.files[0]&&(console.log("form changed",this.files[0]),setFile(this.files[0]))}),$("#uploadSubmit").click(function(evt){evt.preventDefault();var f=getFile();console.log("fetched file",f);var formData=new FormData(f);return console.log("prepared formdata",formData),f?(console.log("sending AJAX upload..."),$(".progress").show(),void $.ajax({type:"POST",url:"/upload",xhr:function(){var myXhr=$.ajaxSettings.xhr();myXhr.upload&&myXhr.upload.addEventListener("progress",progressCb)},data:formData,cache:!1}).error(function(err,status,jqXHR){console.log("xhr error",err,status,jqXHR)}).done(function(data){console.log("xhr done",data)})):(console.log("file empty!"),void $("#err_empty").show())})}();